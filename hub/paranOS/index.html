
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<div style="background-color:#F5F6F7;
            border-bottom-left-radius:15px; 
            border-bottom-right-radius:15px;
            border-top-right-radius:15px;
            border-top-left-radius:15px;
            box-shadow: 6px 6px 12px rgba(0, 0, 0, .25), -6px -6px 12px rgba(255, 255, 255, .08);">
    <figure aligncenter size-full is-resized is-style-default>
        <a href="https://gustavosaez.com.br/hub/">
    <center>
      <img src="https://gustavosaez.com.br/hub/geradordesenhas/favicon.png" height="68">
    </center>
        </a>
    </figure>
  </div>
<meta charset="UTF-8">
<title>ParanOS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{
 --bg:#111;--card:#1c1c1c;--text:#f2f2f2;--muted:#aaa;--accent:#4f8cff;
}
*{box-sizing:border-box}
body{
 margin:0;font-family:system-ui;background:var(--bg);color:var(--text);
 display:flex;justify-content:center;align-items:center;height:100vh;
}
#app{
 width:420px;height:90vh;background:var(--card);
 border-radius:14px;display:flex;flex-direction:column;overflow:hidden;
}
header{padding:14px;border-bottom:1px solid #333;font-weight:600}
#join{padding:16px;display:flex;flex-direction:column;gap:10px}
#chat{flex:1;display:none;flex-direction:column}
#messages{flex:1;padding:16px;overflow:auto}
.msg{margin-bottom:10px}
.nick{font-size:12px;color:var(--muted)}
.text{background:#2a2a2a;padding:8px;border-radius:8px;margin-top:4px}
footer{display:flex;gap:8px;padding:10px;border-top:1px solid #333}
input,button{
 padding:10px;border-radius:8px;border:none;font-size:14px;
}
input{flex:1;background:#111;color:var(--text)}
button{background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
small{opacity:.6}
</style>
</head>
<body>
<div id="app">
<header>ParanOS</header>
</header>
<div id="join">
<input id="nick" placeholder="Nickname">
<input id="room" placeholder="Código da sala (ex: ABCD)">
<button onclick="join()">Entrar</button>
<small>1:1 • tempo real • sem histórico</small>
</div>

<div id="chat">
<div id="messages"></div>
<footer>
<input id="msg" placeholder="Mensagem">
<button onclick="send()">Enviar</button>
</footer>
</div>
</div>

<script src="https://unpkg.com/simple-peer@9/simplepeer.min.js"></script>
<script>
let ws, peer, nick, room;

function join(){
  nick = nickInput.value.trim();
  room = roomInput.value.trim();
  if(!nick || !room) return alert("Preencha tudo");

  joinDiv.style.display = "none";
  chatDiv.style.display = "flex";

  ws = new WebSocket("ws://localhost:8080");

  peer = new SimplePeer({
    initiator: true,
    trickle: false
  });

  peer.on("signal", data => {
    ws.send(JSON.stringify({ type: "signal", room, data }));
  });

  peer.on("data", data => {
    add("peer", data.toString());
  });

  ws.onmessage = e => {
    const msg = JSON.parse(e.data);
    if(msg.type === "signal") {
      peer.signal(msg.data);
    }
    if(msg.type === "full") {
      alert("Sala cheia");
    }
  };
}

function send(){
  const text = msgInput.value.trim();
  if(!text) return;
  peer.send(text);
  add(nick, text);
  msgInput.value = "";
}

function add(n,t){
  const d=document.createElement("div");
  d.className="msg";
  d.innerHTML=`<div class=nick>${n}</div><div class=text>${t}</div>`;
  messages.appendChild(d);
  messages.scrollTop=9999;
}

const nickInput=document.getElementById("nick");
const roomInput=document.getElementById("room");
const joinDiv=document.getElementById("join");
const chatDiv=document.getElementById("chat");
const msgInput=document.getElementById("msg");
const messages=document.getElementById("messages");
</script>
</body>
</html>
